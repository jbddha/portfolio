Project Objective: To establish a comprehensive security information and event management (SIEM) system integrated with security orchestration, automation, and response (SOAR) and case management capabilities. 

    System Architecture Visualization:
        Initiated the project by creating a detailed, color-coded flowchart using draw.io. This visual representation mapped out all the components of the integrated system and their interconnections, providing a clear understanding of the data flow.

    Cloud Environment Provisioning:
        Provisioned one Windows 10 virtual machine (VM) utilizing VMware virtualization technology to simulate an endpoint.
        Provisioned one Ubuntu 22.04 VM using VMware to represent another distinct endpoint.
        Deployed one cloud instance of Ubuntu 22.04 server to host the central Wazuh server and dashboard.
        Deployed one cloud instance of Ubuntu 22.04 server dedicated to hosting The Hive case management system.

    Core Application Configuration:
        Successfully installed and configured The Hive, including its essential dependencies: Elasticsearch for efficient indexing and search, Cassandra for scalable data storage, and Java as the necessary runtime environment.
        Configured the Wazuh server to aggregate and analyze security events.
        Deployed and configured Wazuh agents on both the Windows 10 and Ubuntu 22.04 VMs to collect telemetry data.
        Verified the successful installation and accessibility of both The Hive and Wazuh dashboards through web browser access.
        Seamlessly added the Windows 10 and Ubuntu 22.04 agents to the Wazuh management interface, establishing communication for data transmission.

    Alerting and Threat Detection Implementation:
        Configured the Wazuh dashboard to effectively display and manage security alerts generated by the system.
        Modified the ossec.conf configuration file on the Windows 10 system to enable the ingestion of detailed Sysmon logs into the Wazuh platform, enhancing visibility into endpoint activities.
        Adjusted the ossec.conf file on the Wazuh server to ensure comprehensive log collection from all connected virtual machines. This included enabling the archive functionality within the filebeat.yml configuration file to retain a complete history of events.
        Created an index pattern within the Wazuh environment to facilitate efficient searching and analysis of all archived events, regardless of whether they triggered immediate alerts.
        Developed and implemented a custom Wazuh rule specifically designed to detect and generate alerts upon the identification of Mimikatz usage on the Windows 10 endpoint, providing targeted detection of credential theft attempts.
        Successfully simulated Mimikatz execution on the Windows 10 device and confirmed the generation of a custom alert within the Wazuh dashboard with the defined message: "mimikatz Usage Detected."
        Observed and confirmed the automatic detection capabilities of Wazuh in identifying and alerting on continuous SSH authentication failures targeting the public-facing Ubuntu server, demonstrating its built-in threat detection capabilities for common attack vectors.

    SOAR Integration and Automated Response:
        Integrated the Shuffle SOAR platform with the Wazuh instance by configuring webhook integration tags within the ossec.conf file on the Wazuh server, enabling the automated triggering of SOAR workflows based on Wazuh alerts.
        Implemented automated workflows within Shuffle to enhance incident analysis and response for Windows-based threats:
            Configured automation to automatically extract the SHA256 hash of potentially malicious files detected on the Windows system.
            Integrated with the VirusTotal threat intelligence platform via API to automatically check the reputation of the extracted SHA256 hash.
            Configured Shuffle to send alerts containing the VirusTotal analysis results to The Hive, automatically creating a case for further investigation.
        Developed similar automated workflows within Shuffle to address potential threats identified on the Ubuntu system:
            Designed automation to extract the source IP address from Wazuh alerts related to SSH authentication failures.
            Integrated with the VirusTotal threat intelligence platform to automatically check the reputation of the identified source IP address.
            Configured Shuffle to automatically create a case within The Hive for suspicious SSH activity.
            Implemented an email notification mechanism within Shuffle to promptly inform the SOC analyst about the suspicious SSH activity and the need for responsive action, such as blocking the identified malicious IP address.
